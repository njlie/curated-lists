doctype html
html
  head
    script(src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous")
    script(src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous")
    link(rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous")
    script(src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous")
    link(rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.12/css/all.css" integrity="sha384-G0fIWCsCzJIMAVNQPfjH08cyYaUtMwjJwqiRKxxE/rx96Uroj1BtIQ6MLJuheaO9" crossorigin="anonymous")
    link(rel="stylesheet" href="/style.css")
  body
    nav.navbar.navbar-dark.bg-dark(id="header")
      p.navbar-brand Cool Compilations for Cool People
      button.navbar-toggler(type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation")
        span.navbar-toggler-icon
      div.collapse.navbar-collapse(id="navbarSupportedContent")
        ul.navbar-nav.mr-auto
          li.nav-item.active
            a.nav-link(href="#") Home
              span.sr-only (current)
          li.nav-item
            a.nav-link(id="addPost") Add List
    div.container(id="toolbar-container" style="text-align: center;")
      span(class="toolbar", data-index="0")
        i.fas.fa-lg.fa-music(style="margin-right: 0.5rem;")
        h3(style="display: inline-block;") Music
      span(class="toolbar", data-index="1")
        i.fas.fa-lg.fa-video(style="margin-right: 0.5rem;")
        h3(style="display: inline-block;") Videos
      span(class="toolbar", data-index="2")
        i.fas.fa-lg.fa-image(style="margin-right: 0.5rem;")
        h3(style="display: inline-block;") Images
      span(class="toolbar", data-index="4")
        i.fas.fa-lg.fa-newspaper(style="margin-right: 0.5rem;")
        h3(style="display: inline-block;") Blogs
      span(class="toolbar", data-index="3")
        i.fas.fa-lg.fa-gamepad(style="margin-right: 0.5rem;")
        h3(style="display: inline-block;") Games
    div.container.border(style="text-align: left; overflow: scroll; height: 36rem;")
      div.accordion(id="accordionList")
        while n < 5
          div.card(data-category=icon[categories[randVals[n]]])
            div.card-header(id="heading"+categories[randVals[n]]+n)
              h5.md-0
                i.fas.fa-sm(class="fa-"+icon[categories[randVals[n]]])
                button.btn.btn-link.collapsed(type="button", data-toggle="collapse", data-target="#collapse"+categories[randVals[n]]+n, aria-expanded="false", aria-controls="collapse"+categories[randVals[n]]+n) List #{n}
            div.collapse(id="collapse"+categories[randVals[n]]+n, aria-labelledby="heading"+categories[randVals[n]]+(n++), data-parent="#accordionList")
              div.card-body List Content
  script.
    var paid = false
    const rand = [#{randVals}]
    const categories = "#{data.categories}".split(',')
    const icons = "#{data.fontawesomeArray}".split(',')
    $(document).ready(function () {
      
      $('.toolbar').on('click', function(event) {
        if (this.classList.contains("active")) {
          this.classList.remove('active')
        } else {
          this.classList.add('active')
        }
        const selected = document.querySelectorAll('.toolbar.active')
        console.log(selected)
        var activated = []
        for(var i = 0; i < selected.length; ++i) {
          console.log(selected[i].dataset.index)
          activated.push(selected[i].dataset.index)
        }
        console.log('activated: ', activated)
        var cards = []
        var max = 5
        if (paid) {
          max = rand.length
        }
        for(var index = 0; index < max; ++index) {
          if (activated.includes(rand[index].toString()) || activated.length === 0) {
            var cat = categories[rand[index]]
            var card = `
            <div class="card">
              <div class="card-header" id="heading${cat}${index}">
                <h5 class="md-0">
                  <i class="fas fa-sm fa-${icons[rand[index]]}"></i>
                  <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapse${cat}${index}" aria-expanded="false" aria-controls="collapse${cat}${index}">
                    List ${index}
                  </button>
                </h5>
              </div>
              <div class="collapse" id="collapse${cat}${index}" aria-labelledby="heading${cat}${index} data-parent="#accordionList">
                <div class="card-body">
                  List Content
                </div>
              </div>
            </div>`
            cards.push(card)
          }
        }
        const cardHTML = cards.join('')
        $('#accordionList').html(cardHTML)
      })
    })
  script.
    if (window.monetize) {
      monetize({
        receiver: '$ildm.localtunnel.me'
      }).then(() => {
        paid = true
        document.getElementById('toolbar-container').append('Thanks for paying!')
        document.getElementById('addPost').setAttribute('href', '/post')
        cards = []
        for(var index = 0; index < rand.length; ++index) {
          var cat = categories[rand[index]]
            var card = `
            <div class="card">
              <div class="card-header" id="heading${cat}${index}">
                <h5 class="md-0">
                  <i class="fas fa-sm fa-${icons[rand[index]]}"></i>
                  <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapse${cat}${index}" aria-expanded="false" aria-controls="collapse${cat}${index}">
                    List ${index}
                  </button>
                </h5>
              </div>
              <div class="collapse" id="collapse${cat}${index}" aria-labelledby="heading${cat}${index} data-parent="#accordionList">
                <div class="card-body">
                  List Content
                </div>
              </div>
            </div>`
          cards.push(card)
        }
        const cardHTML = cards.join('')

        $('#accordionList').html(cardHTML)
      })
    }